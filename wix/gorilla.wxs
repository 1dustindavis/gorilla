<?xml version="1.0"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
   <Product Id="*" UpgradeCode="d61005bf-a182-4583-810d-8c33b056b8be" 
            Name="Gorilla"
            Version="1.0.0"
            Manufacturer="Gorilla"
            Language="1033">
      <Package InstallerVersion="200" Compressed="yes" Comments="Windows Installer Package"/>
      <Media Id="1" Cabinet="product.cab" EmbedCab="yes"/>

      <Directory Id="TARGETDIR" Name="SourceDir">
         <Directory Id="CommonAppDataFolder">
            <Directory Id="INSTALLDIR" Name="gorilla">
               <Component Id="Config" Guid="4882d10a-47bf-48ae-8d00-50ea2c9897ec">
                  <File Id="ConfigFile" Source="config_template.yaml"/>
               </Component>
               <Directory Id="BINDIR" Name="bin">
                  <Component Id="Binary" Guid="47855ccd-7eab-464c-a795-26091de8b83a">
                     <File Id="BinaryFile" Source="gorilla.exe"/>
                     <ServiceInstall
                        Id="GorillaServiceInstaller"
                        Type="ownProcess"
                        Vital="yes"
                        Name="Gorilla"
                        DisplayName="Gorilla"
                        Description="Gorilla application management service"
                        Start="auto"
                        ErrorControl="normal"
                        Account="LocalSystem"
                        Arguments='-c "[INSTALLDIR]config_template.yaml" -service' />
                     <ServiceControl
                        Id="GorillaServiceControl"
                        Name="Gorilla"
                        Start="install"
                        Stop="both"
                        Remove="uninstall"
                        Wait="yes" />
                     <Environment Id="PATH" Name="PATH" Value="[BINDIR]" Permanent="no" Part="last" Action="set" System="yes" />
                  </Component>
               </Directory>
            </Directory>
         </Directory>
      </Directory>

      <Feature Id="DefaultFeature" Level="1">
         <ComponentRef Id="Binary"/>
         <ComponentRef Id="Config"/>
      </Feature>
   </Product>
</Wix>
